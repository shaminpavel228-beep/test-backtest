// ============================================
formatDate(timestamp) =>
    y = year(timestamp)
    m = month(timestamp)
    d = dayofmonth(timestamp)
    monthStr = m < 10 ? "0" + str.tostring(m) : str.tostring(m)
    dayStr = d < 10 ? "0" + str.tostring(d) : str.tostring(d)
    str.tostring(y) + "." + monthStr + "." + dayStr

getCurrentDate() =>
    formatDate(time)

getEndDateString() =>
    if useRealTimeEnd
        "ИДЕТ ТОРГОВЛЯ"
    else
        formatDate(endDate)

// Проверка, находится ли текущая свеча в выбранном временном периоде
isInTimePeriod() =>
    inPeriod = true

    if useCustomStartDate
        inPeriod := inPeriod and (time >= startDate)

    if not useRealTimeEnd
        inPeriod := inPeriod and (time <= endDate)

    inPeriod

